<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Asistencia QR</title>
  
  <!-- Enlazamos el CSS -->
  <link rel="stylesheet" href="style.css">

  <!-- Librerías externas -->
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
  <!-- Modal de Login -->
  <div id="login-modal" class="login-modal">
    <div class="login-content">
      <h2>Iniciar Sesión</h2>
      <form id="login-form">
        <input type="text" id="login-user" placeholder="Usuario" required>
        <input type="password" id="login-pass" placeholder="Contraseña" required>
        <button type="submit">Entrar</button>
      </form>
      <p id="login-error" class="login-error"></p>
    </div>
  </div>
  
  <!-- Modal de Administración de Horarios (tabla interactiva) -->
  <div id="schedule-modal" class="schedule-modal">
    <div class="schedule-content">
      <h2>Administrar Horarios</h2>
      <p>Selecciona con click y arrastra las celdas para marcar el bloque de horas.</p>
      <div id="schedule-grid-container">
        <table id="schedule-grid">
          <thead>
            <tr>
              <th>Día \ Hora</th>
              <!-- Horas desde 06:00 hasta 22:00 -->
              <th>06:00</th>
              <th>07:00</th>
              <th>08:00</th>
              <th>09:00</th>
              <th>10:00</th>
              <th>11:00</th>
              <th>12:00</th>
              <th>13:00</th>
              <th>14:00</th>
              <th>15:00</th>
              <th>16:00</th>
              <th>17:00</th>
              <th>18:00</th>
              <th>19:00</th>
              <th>20:00</th>
              <th>21:00</th>
              <th>22:00</th>
            </tr>
          </thead>
          <tbody>
            <!-- Se generan filas para cada día -->
            <tr>
              <th>Lunes</th>
              <td data-day="Lunes" data-hour="06:00"></td>
              <td data-day="Lunes" data-hour="07:00"></td>
              <td data-day="Lunes" data-hour="08:00"></td>
              <td data-day="Lunes" data-hour="09:00"></td>
              <td data-day="Lunes" data-hour="10:00"></td>
              <td data-day="Lunes" data-hour="11:00"></td>
              <td data-day="Lunes" data-hour="12:00"></td>
              <td data-day="Lunes" data-hour="13:00"></td>
              <td data-day="Lunes" data-hour="14:00"></td>
              <td data-day="Lunes" data-hour="15:00"></td>
              <td data-day="Lunes" data-hour="16:00"></td>
              <td data-day="Lunes" data-hour="17:00"></td>
              <td data-day="Lunes" data-hour="18:00"></td>
              <td data-day="Lunes" data-hour="19:00"></td>
              <td data-day="Lunes" data-hour="20:00"></td>
              <td data-day="Lunes" data-hour="21:00"></td>
              <td data-day="Lunes" data-hour="22:00"></td>
            </tr>
            <!-- Repetir para Martes, Miércoles, Jueves, Viernes, Sábado y Domingo -->
            <!-- ... (similar a la fila de Lunes, cambiando el valor de data-day) -->
            <tr>
              <th>Martes</th>
              <td data-day="Martes" data-hour="06:00"></td>
              <td data-day="Martes" data-hour="07:00"></td>
              <td data-day="Martes" data-hour="08:00"></td>
              <td data-day="Martes" data-hour="09:00"></td>
              <td data-day="Martes" data-hour="10:00"></td>
              <td data-day="Martes" data-hour="11:00"></td>
              <td data-day="Martes" data-hour="12:00"></td>
              <td data-day="Martes" data-hour="13:00"></td>
              <td data-day="Martes" data-hour="14:00"></td>
              <td data-day="Martes" data-hour="15:00"></td>
              <td data-day="Martes" data-hour="16:00"></td>
              <td data-day="Martes" data-hour="17:00"></td>
              <td data-day="Martes" data-hour="18:00"></td>
              <td data-day="Martes" data-hour="19:00"></td>
              <td data-day="Martes" data-hour="20:00"></td>
              <td data-day="Martes" data-hour="21:00"></td>
              <td data-day="Martes" data-hour="22:00"></td>
            </tr>
              <th>Miércoles</th>
              <td data-day="Miércoles" data-hour="06:00"></td>
              <td data-day="Miércoles" data-hour="07:00"></td>
              <td data-day="Miércoles" data-hour="08:00"></td>
              <td data-day="Miércoles" data-hour="09:00"></td>
              <td data-day="Miércoles" data-hour="10:00"></td>
              <td data-day="Miércoles" data-hour="11:00"></td>
              <td data-day="Miércoles" data-hour="12:00"></td>
              <td data-day="Miércoles" data-hour="13:00"></td>
              <td data-day="Miércoles" data-hour="14:00"></td>
              <td data-day="Miércoles" data-hour="15:00"></td>
              <td data-day="Miércoles" data-hour="16:00"></td>
              <td data-day="Miércoles" data-hour="17:00"></td>
              <td data-day="Miércoles" data-hour="18:00"></td>
              <td data-day="Miércoles" data-hour="19:00"></td>
              <td data-day="Miércoles" data-hour="20:00"></td>
              <td data-day="Miércoles" data-hour="21:00"></td>
              <td data-day="Miércoles" data-hour="22:00"></td>
            </tr>
            <tr>
              <th>Jueves</th>
              <td data-day="Jueves" data-hour="06:00"></td>
              <td data-day="Jueves" data-hour="07:00"></td>
              <td data-day="Jueves" data-hour="08:00"></td>
              <td data-day="Jueves" data-hour="09:00"></td>
              <td data-day="Jueves" data-hour="10:00"></td>
              <td data-day="Jueves" data-hour="11:00"></td>
              <td data-day="Jueves" data-hour="12:00"></td>
              <td data-day="Jueves" data-hour="13:00"></td>
              <td data-day="Jueves" data-hour="14:00"></td>
              <td data-day="Jueves" data-hour="15:00"></td>
              <td data-day="Jueves" data-hour="16:00"></td>
              <td data-day="Jueves" data-hour="17:00"></td>
              <td data-day="Jueves" data-hour="18:00"></td>
              <td data-day="Jueves" data-hour="19:00"></td>
              <td data-day="Jueves" data-hour="20:00"></td>
              <td data-day="Jueves" data-hour="21:00"></td>
              <td data-day="Jueves" data-hour="22:00"></td>
            </tr>
            <tr>
              <th>Viernes</th>
              <td data-day="Viernes" data-hour="06:00"></td>
              <td data-day="Viernes" data-hour="07:00"></td>
              <td data-day="Viernes" data-hour="08:00"></td>
              <td data-day="Viernes" data-hour="09:00"></td>
              <td data-day="Viernes" data-hour="10:00"></td>
              <td data-day="Viernes" data-hour="11:00"></td>
              <td data-day="Viernes" data-hour="12:00"></td>
              <td data-day="Viernes" data-hour="13:00"></td>
              <td data-day="Viernes" data-hour="14:00"></td>
              <td data-day="Viernes" data-hour="15:00"></td>
              <td data-day="Viernes" data-hour="16:00"></td>
              <td data-day="Viernes" data-hour="17:00"></td>
              <td data-day="Viernes" data-hour="18:00"></td>
              <td data-day="Viernes" data-hour="19:00"></td>
              <td data-day="Viernes" data-hour="20:00"></td>
              <td data-day="Viernes" data-hour="21:00"></td>
              <td data-day="Viernes" data-hour="22:00"></td>
            </tr>
            <tr>
              <th>Sábado</th>
              <td data-day="Sábado" data-hour="06:00"></td>
              <td data-day="Sábado" data-hour="07:00"></td>
              <td data-day="Sábado" data-hour="08:00"></td>
              <td data-day="Sábado" data-hour="09:00"></td>
              <td data-day="Sábado" data-hour="10:00"></td>
              <td data-day="Sábado" data-hour="11:00"></td>
              <td data-day="Sábado" data-hour="12:00"></td>
              <td data-day="Sábado" data-hour="13:00"></td>
              <td data-day="Sábado" data-hour="14:00"></td>
              <td data-day="Sábado" data-hour="15:00"></td>
              <td data-day="Sábado" data-hour="16:00"></td>
              <td data-day="Sábado" data-hour="17:00"></td>
              <td data-day="Sábado" data-hour="18:00"></td>
              <td data-day="Sábado" data-hour="19:00"></td>
              <td data-day="Sábado" data-hour="20:00"></td>
              <td data-day="Sábado" data-hour="21:00"></td>
              <td data-day="Sábado" data-hour="22:00"></td>
            </tr>
            <tr>
              <th>Domingo</th>
              <td data-day="Domingo" data-hour="06:00"></td>
              <td data-day="Domingo" data-hour="07:00"></td>
              <td data-day="Domingo" data-hour="08:00"></td>
              <td data-day="Domingo" data-hour="09:00"></td>
              <td data-day="Domingo" data-hour="10:00"></td>
              <td data-day="Domingo" data-hour="11:00"></td>
              <td data-day="Domingo" data-hour="12:00"></td>
              <td data-day="Domingo" data-hour="13:00"></td>
              <td data-day="Domingo" data-hour="14:00"></td>
              <td data-day="Domingo" data-hour="15:00"></td>
              <td data-day="Domingo" data-hour="16:00"></td>
              <td data-day="Domingo" data-hour="17:00"></td>
              <td data-day="Domingo" data-hour="18:00"></td>
              <td data-day="Domingo" data-hour="19:00"></td>
              <td data-day="Domingo" data-hour="20:00"></td>
              <td data-day="Domingo" data-hour="21:00"></td>
              <td data-day="Domingo" data-hour="22:00"></td>
            </tr>
          </tbody>
        </table>
      </div>
      <div id="schedule-details">
        <label for="class-info">Información de la Clase (ej. "Inglés"):</label>
        <input type="text" id="class-info">
        <button id="add-schedule">Añadir Horario</button>
      </div>
      <div id="schedule-list" class="schedule-list">
        <!-- Aquí se listarán los bloques de horarios -->
      </div>
      <button id="close-schedule-modal">Cerrar</button>
    </div>
  </div>
  
  <!-- Contenedor principal (inicialmente oculto hasta el login) -->
  <div class="container" style="display: none;">
    <!-- Menú lateral (sidebar) -->
    <aside class="sidebar">
      <h2>Menú de Funciones</h2>
      <button id="generate-teacher-qr">Generar QR del Profesor</button>
      <div class="toggle-group">
        <input type="checkbox" id="mute-voice">
        <label for="mute-voice">Silenciar voz</label>
      </div>
      <div class="toggle-group">
        <input type="checkbox" id="burst-mode">
        <label for="burst-mode">Modo Ráfaga</label>
      </div>
      <!-- Nuevos botones en el menú -->
      <button id="edit-attendance">Editar Asistencias Manual</button>
      <button id="make-report">Hacer Reporte</button>
      <button id="show-students">Mostrar Lista de Alumnos</button>
      <button id="send-info">Mandar Información</button>
      <!-- Botón para administrar horarios -->
      <button id="manage-schedule">Administrar Horarios</button>
      <!-- Contenedor para mostrar el QR del profesor -->
      <div id="teacher-qr-container" class="qr-container"></div>
    </aside>

    <!-- Contenido principal -->
    <div class="main-content">
      <header>
        <div class="logo">
          <img src="assets/LogoQR.png" alt="Logo del Sistema">
        </div>
        <h1>Registro de Asistencia QR</h1>
      </header>

      <!-- Área de notificaciones (toast) -->
      <div id="notification" class="notification"></div>

      <main>
        <!-- Sección del lector QR -->
        <section id="scanner-section">
          <h2>Escáner QR</h2>
          <div class="qr-reader-container">
            <div id="qr-reader"></div>
          </div>
          <button id="toggle-scan">Detener Escaneo</button>
        </section>

        <!-- Sección de asistencias registradas -->
        <section id="attendance-section">
          <h2>Asistencias Registradas</h2>
          <ul id="attendance-list"></ul>
          <button id="export-excel">Exportar a Excel</button>
        </section>
      </main>
    </div>
  </div>

  <!-- Enlazamos el JavaScript -->
  <script src="script.js"></script>
</body>
</html>